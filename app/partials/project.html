<section data-ng-if="loaded">

    <div class="page-header">
        <h1 class="text-primary">{{project.name}}</h1>
    </div>

    <div class="container">
        <!-- Upload Submissions -->
        <form data-ng-if="isStudent && project.can_submit">
            <h2>New Submittion</h2>
            <div class="form-group">
                <label for="codeFile">Code</label>
                <input type="file" id="codeFile" name="codeFile" data-ng-file-select data-ng-model="code.file" data-ng-multiple="false" required>
            </div>
            <button type="submit" data-ng-click="submitCode()" class="btn btn-primary">Submit</button>
        </form>

        <hr>
        <!-- Current Submissions -->
        <p class="lead text-info row" data-ng-if="submissions.length == 0">No submissions, yet!</p>
        <div class="panel-group" id="submissionsAccordion">

            <div data-ng-repeat="submission in submissions" data-ng-class="{'panel':true, 'panel-info':!submission.processed, 'panel-danger':submission.processed && !submission.compile_status, 'panel-success':submission.processed && submission.compile_status}">
                <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-parent="#submissionsAccordion" data-target="#{{submission.id}}" >
                        <span data-ng-if="!submission.processed" class="pull-right"><img id="spinner" ng-src="images/spin.gif"></span>
                        <span data-ng-if="submission.processed && submission.compile_status" class="pull-right"><i class="glyphicon glyphicon-ok-circle"></i></span>
                        <span data-ng-if="submission.processed && !submission.compile_status" class="pull-right"><i class="glyphicon glyphicon-remove-circle"></i></span>
                        Submission {{submission.id}} | {{submission.created_at_pretty}}
                      </a>
                    </h4>
                </div>
                <div id="{{submission.id}}" class="panel-collapse collapse">
                    <div class="panel-body">
                        <pre>{{submission.compiler_out}}</pre>

                        <div class="panel-group" id="{{submission.id}}Accordion">
                            <div data-ng-repeat="test in submission.tests" data-ng-class="{'panel':true, 'panel-success':test.success, 'panel-default':!test.success}">
                                <div class="panel-heading">
                                    <h4 class="panel-title">
                                      <a data-toggle="collapse" data-parent="#{{submission.id}}Accordion" data-target="#{{submission.id}}{{test.name}}" >
                                        <span data-ng-if="test.success" class="pull-right text-success"><i class="glyphicon glyphicon-ok-circle"></i></span>
                                        <span data-ng-if="!test.success" class="pull-right text-danger"><i class="glyphicon glyphicon-remove-circle"></i></span>
                                        {{test.name}}
                                      </a>
                                    </h4>
                                </div>
                                <div id="{{submission.id}}{{test.name}}" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <div data-ng-class="{'list-group':true, 'list-group-item-success':case.passed, 'list-group-item-danger':!case.passed}">
                                            <div data-ng-repeat="case in test.cases" class="list-group-item">
                                                <div class="list-group-item-heading">
                                                    <span data-ng-if="case.passed" class="text-success"><i class="glyphicon glyphicon-ok-circle"></i></span>
                                                    <span data-ng-if="!case.passed" class="text-danger"><i class="glyphicon glyphicon-remove-circle"></i></span> {{case.name}}
                                                </div>
                                                <pre data-ng-if="!case.passed" class="list-group-item-text" >{{case.detail}}</pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</section>
